function y = GEN_lin_interp3d_basis(t1,t2,t3,M);

for j=1:length(t3)
   t  = t3(j);
   y  = M(2,1,1)*(1-t1)*(1-t2)'*(1-t)+...
        +M(2,2,1)*(t1)*(1-t2)'*(1-t)+...
        +M(1,2,1)*(t1)*(t2)'*(1-t)+...
        +M(1,1,1)*(1-t1)*(t2)'*(1-t)+...
        +M(2,1,2)*(1-t1)*(1-t2)'*(t)+...
        +M(2,2,2)*(t1)*(1-t2)'*(t)+...
        +M(1,2,2)*(t1)*(t2)'*(t)+...
        +M(1,1,2)*(1-t1)*(t2)'*(t);
end
